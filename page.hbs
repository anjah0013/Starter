{{!< default}}

{{#post}}
<article class="gh-article {{post_class}}">
    <header class="gh-page-head">
        <h1 class="gh-page-title">{{title}}</h1>
    </header>

    {{#has slug="about, про-мене, bio, information"}}
    {{#if feature_image}}
        {{!-- Якщо є картинка (в налаштуваннях теми або Feature Image сторінки), вмикаємо макет --}}
        <div class="gh-about-layout gh-container" id="about-container" data-split="{{@custom.about_page_text_split}}">
            <div class="gh-about-column" id="left-side"></div>
            
            <div class="gh-about-column gh-about-center">
                <div class="gh-about-photo-wrap">
                    {{#if @custom.about_image}}
                        <img src="{{@custom.about_image}}" alt="{{title}}" class="gh-about-photo-img" />
                    {{else}}
                        <img src="{{feature_image}}" alt="{{title}}" class="gh-about-photo-img" />
                    {{/if}}
                </div>
            </div>

            <div class="gh-about-column" id="right-side"></div>
        </div>

        {{!-- Весь контент з редактора тут прихований і чекає на розподіл --}}
        <div id="hidden-content" style="display:none !important;">
            {{content}}
        </div>

        <script>
        (function() {
            function balanceAboutContent() {
                const container = document.getElementById('about-container');
                const hidden = document.getElementById('hidden-content');
                const left = document.getElementById('left-side');
                const right = document.getElementById('right-side');
                
                if (!hidden || !left || !right || !container) return;

                const elements = Array.from(hidden.children);
                if (elements.length === 0) {
                    left.innerHTML = hidden.innerHTML;
                    return;
                }

                const splitSetting = container.dataset.split || 'Balanced';
                let splitRatio = 0.5;
                if (splitSetting === 'Mostly left') splitRatio = 0.8;
                else if (splitSetting === 'More left') splitRatio = 0.65;
                else if (splitSetting === 'More right') splitRatio = 0.35;
                else if (splitSetting === 'Mostly right') splitRatio = 0.2;

                const totalWeight = hidden.innerText.length;
                let currentWeight = 0;
                let splitIndex = 0;

                for (let i = 0; i < elements.length; i++) {
                    currentWeight += elements[i].innerText.length;
                    if (currentWeight >= totalWeight * splitRatio) {
                        splitIndex = i;
                        break;
                    }
                }

                left.innerHTML = '';
                right.innerHTML = '';

                elements.forEach((el, index) => {
                    const clone = el.cloneNode(true);
                    if (index <= splitIndex) {
                        left.appendChild(clone);
                    } else {
                        right.appendChild(clone);
                    }
                });
            }

            window.addEventListener('load', balanceAboutContent);
            balanceAboutContent();
            
            // Повторна перевірка для повільного завантаження
            setTimeout(balanceAboutContent, 500);
            setTimeout(balanceAboutContent, 2000);
        })();
        </script>
    {{else}}
        {{!-- Якщо картинки немає, показуємо стандартний макет --}}
        <div class="gh-content gh-canvas">
            {{content}}
        </div>
    {{/if}}
    {{else}}
        {{!-- Стандартний макет для інших сторінок --}}
        <div class="gh-content gh-canvas">
            {{content}}
        </div>
    {{/has}}

</article>
{{/post}}