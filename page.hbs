{{!< default}}

{{#post}}
<article class="gh-article {{post_class}}">
    <header class="gh-page-head">
        <h1 class="gh-page-title">{{title}}</h1>
    </header>

    {{#has slug="about"}}
    <div class="gh-about-layout gh-container" id="about-container" data-split="{{@custom.about_page_text_split}}">
        <div class="gh-about-column" id="left-side"></div>
        
        <div class="gh-about-column gh-about-center">
            <div class="gh-about-photo-wrap">
                {{#if @custom.about_image}}
                    <img src="{{@custom.about_image}}" alt="{{title}}" class="gh-about-photo-img" />
                {{else if feature_image}}
                    <img src="{{feature_image}}" alt="{{title}}" class="gh-about-photo-img" />
                {{else}}
                    <div style="background: #eee; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;">PHOTO</div>
                {{/if}}
            </div>
        </div>

        <div class="gh-about-column" id="right-side"></div>
    </div>

    {{!-- Hidden Source --}}
    <div id="hidden-content" style="display:none !important;">
        {{content}}
    </div>

    <script>
    (function() {
        function balanceContent() {
            const container = document.getElementById('about-container');
            const hidden = document.getElementById('hidden-content');
            const left = document.getElementById('left-side');
            const right = document.getElementById('right-side');
            
            if (!hidden || !left || !right || !container) return;

            const elements = Array.from(hidden.children);
            if (elements.length === 0) return;

            // Визначаємо коефіцієнт розподілу на основі налаштувань
            const splitSetting = container.dataset.split || 'Balanced';
            let splitRatio = 0.5;
            
            if (splitSetting === 'Mostly left') splitRatio = 0.8;
            else if (splitSetting === 'More left') splitRatio = 0.65;
            else if (splitSetting === 'More right') splitRatio = 0.35;
            else if (splitSetting === 'Mostly right') splitRatio = 0.2;

            // Рахуємо загальну кількість "ваги" (кількість літер)
            const totalWeight = hidden.innerText.length;
            let currentWeight = 0;
            let splitIndex = 0;

            // Шукаємо індекс елемента для розриву
            for (let i = 0; i < elements.length; i++) {
                currentWeight += elements[i].innerText.length;
                if (currentWeight >= totalWeight * splitRatio) {
                    splitIndex = i;
                    break;
                }
            }

            // Очищуємо і заповнюємо
            left.innerHTML = '';
            right.innerHTML = '';

            elements.forEach((el, index) => {
                const clone = el.cloneNode(true);
                if (index <= splitIndex) {
                    left.appendChild(clone);
                } else {
                    right.appendChild(clone);
                }
            });
        }

        // Запуск після повного завантаження
        window.addEventListener('load', balanceContent);
        // Запуск відразу
        balanceContent();
        // Резервний запуск
        setTimeout(balanceContent, 1000);
    })();
    </script>

    {{else}}
    <div class="gh-content gh-canvas">
        {{content}}
    </div>
    {{/has}}

</article>
{{/post}}